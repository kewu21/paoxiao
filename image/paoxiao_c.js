var emptyShout=["\u6ca1\u6709\u5b57\u4f60\u8ba9\u6211\u600e\u4e48\u5486\u54ee\u963f\uff01\uff01\uff01\u4ee5\u4e3a\u6211\u5c3c\u739b\u662f\u673a\u5668\u732b\u963f\uff01\uff01\uff01\uff01","\u6559\u4e3b\u9762\u5bf9\u4e00\u7247\u7a7a\u767d\u7684\u8f93\u5165\u6846\u8868\u793a\u538b\u529b\u5f88\u5927\u6709\u6728\u6709\uff01\uff01\uff01","\u597d\u6b79\u5199\u51e0\u4e2a\u5b57\u5427\uff01\uff01\uff01\u6ca1\u6709\u5b57\u6211\u600e\u4e48\u5486\u54ee\u554a\u554a\u554a\uff01\uff01\uff01","\u8fd9\u8d27\u5486\u54ee\u7684\u65f6\u5019\u4e0d\u5199\u5b57\u6709\u6ca1\u6709\uff01\uff01\u718a\u5b69\u5b50\u633a\u4f1a\u73a9\u554a\u554a\uff01\uff01"],
TARGET_CHAR="\u3002\uff0c.,\uff1b;!\uff01\n".split(""),SW=[["\u4ec0\u4e48","\u795e\u9a6c"],["\u4f60\u5988","\u5c3c\u739b"],["\u6ca1\u6709","\u6728\u6709"],["\u600e\u4e48","\u80bf\u4e48"],["\u6211","\u52b3\u8d44"],["\u6211\u4eec","\u52b3\u8d44"]],output=[],finalString="",textToPaste="",retweetBtn=$(".retweet"),userComposed=!1,contentChanged=!1,contentEle=$("#content");
$(document).ready(function(){var a=Math.floor(7*Math.random()).toString();$.get("default_txt/text"+a+".txt",function(a){contentEle.val(a);contentEle.attr("disabled","")});"none"!=$("#successIfno").css("display")&&$("#successInfo").hide(2E3)});contentEle.focus(function(){userComposed||(userComposed=!0,contentEle.val(""))});contentEle.change(function(){contentChanged=!0});
$(".genButton").click(function(){contentChanged&&($("#output").hide(),contentChanged=!1);if(""==contentEle.val())$("#output").html(emptyShout[Math.floor(Math.random()*emptyShout.length)]),$("#output").show(),retweetBtn.hide(),$("#secondGen").hide();else{paoxiao(contentEle.val().replace(/^\s+|\s+$/g,""));$("#output").show("slow");textToPaste="";for(var a=$("#output").find("p"),b=0;b<a.length;b++)textToPaste+=a[b].innerHTML.replace(/^\s+|\s+$/g,"")+"\r\n";retweetBtn.show();$("#secondGen").show();var c=
new ZeroClipboard(document.getElementById("toClipboard"),{moviePath:"image/ZeroClipboard.swf"});c.on("dataRequested",function(a,b){c.setText(textToPaste)});c.on("complete",function(a,b){alert("\u5df2\u7ecf\u5486\u54ee\u5230\u526a\u8d34\u677f\uff01\uff01\uff01")})}});function paoxiao(a){finalString="";output=process(a);for(a=0;a<output.length;a++)finalString+="<p>"+output[a]+"</p>";$("#output").find("p").empty();$("#output").html(finalString)}
function makeFun(a){a.replace(/^\s+|\s+$/g,"");if(1>10*Math.random()){var b=Math.floor(Math.random()*a.length);a=a.substring(0,b)+"\u6ce5\u9a6c"+a.substring(b,a.length)}else 2>10*Math.random()&&(a="\u5c3c\u739b"+a);1>10*Math.random()&&(a+=randomShot("\u554a",1,5));3>10*Math.random()&&(a+="\u6709\u6728\u6709"+randomShot("\uff01",3,6),3>10*Math.random()&&(a+="\u4eb2"+randomShot("\uff01",3,6)));for(b=SW.length;b--;)a=a.replace(SW[b][0],SW[b][1]);return a+=randomShot("\uff01",3,10)}
function process(a){for(var b=[],c=0,d=0;d<a.length;d++)if(-1!=$.inArray(a.charAt(d),TARGET_CHAR)&&(5<d-c||d==a.length-1)){var e=a.substring(c,d);0!=c&&(e=e.substring(1,e.length));c=d;b.push(makeFun(e))}c<a.length-1&&(a=a.substring(c,a.length),0!=c&&(a=a.substring(1,a.length)),a=makeFun(a.replace(/^\s+|\s+$/g,"")),b.push(a));b[b.length-1]+=randomShot("\uff01",5,10);3>10*Math.random()?b.push("\u4eb2\uff0c\u5305\u90ae\u54e6\u4eb2"+randomShot("\uff01",5,10)):3>10*Math.random()&&b.push("\u4f60\u4f24\u4e0d\u8d77"+
randomShot("\u554a",1,5)+randomShot("\uff01",5,10));return b}function randomShot(a,b,c){b=Math.floor(Math.random()*(c-b))+b;c="";for(var d=0;d<b;d++)c+=a;return c}
function submit_post(){$.ajax({url:"text_to_image.php",data:{text:textToPaste},type:"post",success:function(a){a=(JSON&&JSON.parse(a)||$.parseJSON(a)).imgurl;a={url:location.href,type:"4",count:"",appkey:"26595521",title:"\u6211\u521a\u521a\u7528 @\u5486\u54ee\u957f\u5fae\u535a \u5199\u4e86\u4e00\u7bc7\u957f\u5fae\u535a: "+a+" \u4f60\u4e5f\u6765\u8bd5\u8bd5\u5427\uff1a",pic:a,ralateUid:"",language:"zh_cn",rnd:(new Date).valueOf()};var b=[],c;for(c in a)b.push(c+"="+encodeURIComponent(a[c]||""));window.open("http://v.t.sina.com.cn/share/share.php?"+
b.join("&")+"&source=bookmark","_blank","width=450,height=400")}})};
